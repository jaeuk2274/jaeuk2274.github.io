---
title: 스프링 핵심 기술-06.MessageSource
date: 2019-12-07
categories:
- Spring
tags:
- Spring 
- IoC Container
- MessageSource
comments : true
---

## IoC 컨테이너 7부 : MessageSource

``` java 
public interface ApplicationContext extends EnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory, MessageSource, ApplicationEventPublisher, ResourcePatternResolver {
...
}
```
MessageSource

국제화 (i18n) 기능을 제공하는 인터페이스.
ApplicationContext extends MessageSource
● getMessage(String code, Object[] args, String, default, Locale, loc)
● ...

스프링 부트를 사용한다면 별다른 설정 필요없이 messages.properties 사용할 수 있음

● messages.properties
greeting=Hello, {0}

● messages_ko_kr.properties
greeting=안녕, {0}

``` java 
@Component
public class AppRunner implements ApplicationRunner {

    @Autowired
    MessageSource messageSource;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(messageSource.getClass());
        System.out.println(messageSource.getMessage("greeting", new String[]{"jaeuk"}, Locale.KOREA));
        System.out.println(messageSource.getMessage("greeting", new String[]{"jaeuk"}, Locale.getDefault()));
    }
}
```  
``` 
class org.springframework.context.support.ResourceBundleMessageSource
안녕, jaeuk
Hello, jaeuk
``` 


ResourceBundleMessageSource 이 빈이 메세지 messagese 라는 리소스 번들을 읽게 되어 있는 것.


부트에서 자동으롷 ㅐ주는 것을 우리가 할 수도 있다 다시 리로드

``` java 
@SpringBootApplication
@PropertySource("classpath:/app.properties")
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Bean
    public MessageSource messageSource(){
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:/messages");
        messageSource.setDefaultEncoding("UTF-8");
        return messageSource;
    }
}

```



다음은
1초마다 찍으면서
리소스를 캐시하는 시간을 3초까지만 캐싱을 하고 다시 읽도록 세팅
1초마다 메세지가 찍힌다.



``` java 
@Component
public class AppRunner implements ApplicationRunner {

    @Autowired
    MessageSource messageSource;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        while(true){
            System.out.println(messageSource.getClass());
            System.out.println(messageSource.getMessage("greeting", new String[]{"jaeuk"}, Locale.KOREA));
            System.out.println(messageSource.getMessage("greeting", new String[]{"jaeuk"}, Locale.getDefault()));
            Thread.sleep(1000l);
        }
    }
}
``` 
``` java 
@SpringBootApplication
@PropertySource("classpath:/app.properties")
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Bean
    public MessageSource messageSource(){
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:/messages");
        messageSource.setDefaultEncoding("UTF-8");
        messageSource.setCacheSeconds(3);
        return messageSource;
    }
}
```


1초마다 
찍으면서
리소스를 캐시하는 시간을 3초까지만 캐싱을 하고 다시 읽도록 세팅
1초마다 메세지가 찍힌다.


이 상태에서

프로퍼티 메세지를 변경하고 빌드만 하면
변경된 메세지가 바로 적용되어서 보여진다.




