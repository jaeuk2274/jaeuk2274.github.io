---
title: "부트 개념과 활용-20.ExceptionHandler"
date: 2019-12-19
categories:
- Back-end
tags:
- Spring 
- Boot
- ExceptionHandler
comments : true
---

## 스프링 웹 MVC 9부: ExceptionHandler


### 스프링 @MVC 예외 처리 방법
1. @ControllerAdvice
2. @ExceptionHandler

### 스프링 부트가 제공하는 기본 예외 처리기
BasicErrorController
HTML과 JSON 응답 지원
커스터마이징 방법
ErrorController 구현


### 커스텀 에러 페이지
상태 코드 값에 따라 에러 페이지 보여주기
src/main/resources/static|template/error/
404.html
5xx.html
ErrorViewResolver 구현




이미 자주 봤던, 에러 핸들러가 처리해 준 결과.
(브라우저 요청 -> 에러 페이지)
![에러페이지](https://github.com/jaeuk2274/jaeuk2274.github.io/blob/master/_posts/img/%EC%8A%A4%ED%94%84%EB%A7%81%20%EB%B6%80%ED%8A%B8%20%EA%B0%9C%EB%85%90%EA%B3%BC%20%ED%99%9C%EC%9A%A9/05.%E1%84%8B%E1%85%A6%E1%84%85%E1%85%A5%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5.png?raw=true)



하지만 이렇게 요청을 하면 제이슨으로 응답이 온다. 
(머신 클라이언트 요청 -> json)
![curl 제이슨](https://github.com/jaeuk2274/jaeuk2274.github.io/blob/master/_posts/img/%EC%8A%A4%ED%94%84%EB%A7%81%20%EB%B6%80%ED%8A%B8%20%EA%B0%9C%EB%85%90%EA%B3%BC%20%ED%99%9C%EC%9A%A9/04.curl.png?raw=true)      


정확하게는 BasicErrorController 안에 다 들어있다.
~~~java
@Controller
@RequestMapping("${server.error.path:${error.path:/error}}")
public class BasicErrorController extends AbstractErrorController {
...

// text / html 요청인 경우 - 에러페이지 반환
	@RequestMapping(produces = MediaType.TEXT_HTML_VALUE)
	public ModelAndView errorHtml(HttpServletRequest request, HttpServletResponse response) {
		HttpStatus status = getStatus(request);
		Map<String, Object> model = Collections
				.unmodifiableMap(getErrorAttributes(request, isIncludeStackTrace(request, MediaType.TEXT_HTML)));
		response.setStatus(status.value());
		ModelAndView modelAndView = resolveErrorView(request, response, status, model);
		return (modelAndView != null) ? modelAndView : new ModelAndView("error", model);
	}
  
...
// json으로 반환
	@RequestMapping
	public ResponseEntity<Map<String, Object>> error(HttpServletRequest request) {
		HttpStatus status = getStatus(request);
		if (status == HttpStatus.NO_CONTENT) {
			return new ResponseEntity<>(status);
		}
		Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));
		return new ResponseEntity<>(body, status);
	}
~~~





### 예제 코드 실습





익셉션 클래스를 전역적으로 사용하고 싶다

@컨트롤러어드바이스

사용해서 






=를 상속받아서 사용. ㅋ스텀하면서 레퍼런스에서 권장하는 방법

응답의 상태값에 따라 다른 웹페이지를 보여주고 싶다면

error 디렉토리 만들고

404.html (html이름이 상태값과 같아야 한다.)

아니면

5xx.html (500번대 발생하는 에러)

이런 커스텀에 다 걸리지 않으면

베이직 에러 컨트롤러가 띄우는 에러 화면.



많은 커스텀 하가ㅗ싶으면

에러 뷰 리졸버 규현.

좀더 동적인 컨텐츠 뷰로 좀 더 다양하게 커스텀 가능 에러정보들 넣어서 꾸미는 것 가능.



