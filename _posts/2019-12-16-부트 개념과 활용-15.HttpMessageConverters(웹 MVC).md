---
title: "부트 개념과 활용-15.HttpMessageConverters/ViewResolve(웹 MVC)"
date: 2019-12-16
categories:
- Back-end
tags:
- Spring 
- Boot
- Test
comments : true
---

이 문서는 추후 정리 예정인 문서입니다.

## Spring-Boot-HttpMessageConverters

(https://docs.spring.io/spring/docs/5.0.7.RELEASE/spring-framework-reference/web.html#mvc-config-message-converters)[https://docs.spring.io/spring/docs/5.0.7.RELEASE/spring-framework-reference/web.html#mvc-config-message-converters]          

- HTTP 요청 본문을 객체로 변경하거나, 객체를 HTTP 응답 본문으로 변경할 때 사용 
  {“username”:”keesun”, “password”:”123”} <-> User
  - @ReuqestBody     
  - @ResponseBody       

~~~java
@RestController
public class UserController {

    @GetMapping("/hello")
    public String hello(){
        return "hello";
    }

    @PostMapping("/user")
    // public @ResponseBody User create(@RequestBody User user) {
    // @RestController 사용시 @ResponseBody 생략가능
    public @ResponseBody User create(@RequestBody User user) {
        return null;
    }
}
~~~

일반적으로 보낼 때 컨텐츠 타입 : json, 본문 : json으로 보낸다면(제이슨 요청, 제이슨 본문이 들어온다면)

제이슨 메세지 컨버터가 사용되어서 유저 객체로 리턴이 된다. (유저 객체로 파라미터 받는다.)

이후 유저를 리턴할 때, 변환해서 보내야 하니까 

기본적으로 컴포지션 타입(안에 여러 개의 프로퍼티)인 제이선 메세지 컨버터가 사용되어 제이슨으로 변환된다.

만약 그냥 문자열 반환이라면(return string) 스트링 메세지 컨버터가 사용된다.

인트도 마찬가지.(스트링 메세지 컨버터 사용)


@RestController가 붙어있으면 @ResponseBody 생략 가능
~~~java
    @PostMapping("/users/create")
    public User create(@RequestBody User user) {
        return user;
    }
~~~


~~~
import static org.hamcrest.Matchers.equalTo;
import static org.hamcrest.Matchers.is;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;

@ExtendWith(SpringExtension.class)
@WebMvcTest(UserController.class)
class UserControllerTest {

    @Autowired
    MockMvc mockMvc; // @WebMvcTest 사용시 자동으로 만들어짐

    @Test
    public void hello() throws Exception {
        mockMvc.perform(get("/hello"))
                .andExpect(status().isOk())
                .andExpect(content().string("hello"));
    }

    @Test
    public  void createUser_JSON() throws Exception {
        String userJson = "{\"username\":\"jaeuk\", \"password\":\"123\"}";
        System.out.println(userJson);
        mockMvc.perform(post("/users/create")
                .contentType(MediaType.APPLICATION_JSON)
                .accept(MediaType.APPLICATION_JSON)
                .content(userJson))
                .andExpect(jsonPath("$.username", is(equalTo("jaeuk"))))
                .andExpect(jsonPath("$.password", is(equalTo("123"))));
    }
}
~~~

>APPLICATION_JSON_UTF8 는 이제 사용하지 않는다.
APPLICATION_JSON Chrome과 같은 주요 브라우저는 이제 사양을 준수 하고 charset=UTF-8매개 변수 를 요구하지 않고 
(UTF-8 특수 문자를 올바르게 해석 하므로 5.2를 기준)       


## ViewResolve


뷰 리접러 중 하나 

